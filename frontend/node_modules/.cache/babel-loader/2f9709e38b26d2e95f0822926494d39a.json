{"ast":null,"code":"import _slicedToArray from\"/Users/shawn/Desktop/Web development/reactNew/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,useLayoutEffect,useCallback}from\"react\";var logoutTimer;export var useAuth=function useAuth(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tokenExpirationState=_useState6[0],setTokenExpirationState=_useState6[1];var login=useCallback(function(uid,token,expirationDate){setToken(token);setUserId(uid);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationState(tokenExpirationDate);localStorage.setItem(\"userData\",JSON.stringify({userId:uid,token:token,expiration:tokenExpirationDate.toISOString()}));},[]);var logout=useCallback(function(){setToken(null);setTokenExpirationState(null);setUserId(null);localStorage.removeItem(\"userData\");},[]);useEffect(function(){if(token&&tokenExpirationState){var remainingTime=tokenExpirationState.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationState]);useLayoutEffect(function(){var storedData=JSON.parse(localStorage.getItem(\"userData\"));if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,new Date(storedData.expiration));}},[login]);return{token:token,userId:userId,login:login,logout:logout};};","map":{"version":3,"names":["useEffect","useState","useLayoutEffect","useCallback","logoutTimer","useAuth","token","setToken","userId","setUserId","tokenExpirationState","setTokenExpirationState","login","uid","expirationDate","tokenExpirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem"],"sources":["/Users/shawn/Desktop/Web development/reactNew/frontend/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useEffect, useState, useLayoutEffect, useCallback } from \"react\";\n\nlet logoutTimer;\n\nexport const useAuth = () => {\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(null);\n  const [tokenExpirationState, setTokenExpirationState] = useState();\n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationState(tokenExpirationDate);\n    localStorage.setItem(\n      \"userData\",\n      JSON.stringify({\n        userId: uid,\n        token: token,\n        expiration: tokenExpirationDate.toISOString(),\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    setTokenExpirationState(null);\n    setUserId(null);\n    localStorage.removeItem(\"userData\");\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationState) {\n      const remainingTime =\n        tokenExpirationState.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationState]);\n\n  useLayoutEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem(\"userData\"));\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(\n        storedData.userId,\n        storedData.token,\n        new Date(storedData.expiration)\n      );\n    }\n  }, [login]);\n\n  return { token, userId, login, logout };\n};\n"],"mappings":"4IAAA,OAASA,SAAT,CAAoBC,QAApB,CAA8BC,eAA9B,CAA+CC,WAA/C,KAAkE,OAAlE,CAEA,GAAIC,YAAJ,CAEA,MAAO,IAAMC,QAAO,CAAG,QAAVA,QAAU,EAAM,CAC3B,cAA0BJ,QAAQ,CAAC,KAAD,CAAlC,wCAAOK,KAAP,eAAcC,QAAd,eACA,eAA4BN,QAAQ,CAAC,IAAD,CAApC,yCAAOO,MAAP,eAAeC,SAAf,eACA,eAAwDR,QAAQ,EAAhE,yCAAOS,oBAAP,eAA6BC,uBAA7B,eAEA,GAAMC,MAAK,CAAGT,WAAW,CAAC,SAACU,GAAD,CAAMP,KAAN,CAAaQ,cAAb,CAAgC,CACxDP,QAAQ,CAACD,KAAD,CAAR,CACAG,SAAS,CAACI,GAAD,CAAT,CACA,GAAME,oBAAmB,CACvBD,cAAc,EAAI,GAAIE,KAAJ,CAAS,GAAIA,KAAJ,GAAWC,OAAX,GAAuB,KAAO,EAAP,CAAY,EAA5C,CADpB,CAEAN,uBAAuB,CAACI,mBAAD,CAAvB,CACAG,YAAY,CAACC,OAAb,CACE,UADF,CAEEC,IAAI,CAACC,SAAL,CAAe,CACbb,MAAM,CAAEK,GADK,CAEbP,KAAK,CAAEA,KAFM,CAGbgB,UAAU,CAAEP,mBAAmB,CAACQ,WAApB,EAHC,CAAf,CAFF,EAQD,CAdwB,CActB,EAdsB,CAAzB,CAgBA,GAAMC,OAAM,CAAGrB,WAAW,CAAC,UAAM,CAC/BI,QAAQ,CAAC,IAAD,CAAR,CACAI,uBAAuB,CAAC,IAAD,CAAvB,CACAF,SAAS,CAAC,IAAD,CAAT,CACAS,YAAY,CAACO,UAAb,CAAwB,UAAxB,EACD,CALyB,CAKvB,EALuB,CAA1B,CAOAzB,SAAS,CAAC,UAAM,CACd,GAAIM,KAAK,EAAII,oBAAb,CAAmC,CACjC,GAAMgB,cAAa,CACjBhB,oBAAoB,CAACO,OAArB,GAAiC,GAAID,KAAJ,GAAWC,OAAX,EADnC,CAEAb,WAAW,CAAGuB,UAAU,CAACH,MAAD,CAASE,aAAT,CAAxB,CACD,CAJD,IAIO,CACLE,YAAY,CAACxB,WAAD,CAAZ,CACD,CACF,CARQ,CAQN,CAACE,KAAD,CAAQkB,MAAR,CAAgBd,oBAAhB,CARM,CAAT,CAUAR,eAAe,CAAC,UAAM,CACpB,GAAM2B,WAAU,CAAGT,IAAI,CAACU,KAAL,CAAWZ,YAAY,CAACa,OAAb,CAAqB,UAArB,CAAX,CAAnB,CACA,GACEF,UAAU,EACVA,UAAU,CAACvB,KADX,EAEA,GAAIU,KAAJ,CAASa,UAAU,CAACP,UAApB,EAAkC,GAAIN,KAAJ,EAHpC,CAIE,CACAJ,KAAK,CACHiB,UAAU,CAACrB,MADR,CAEHqB,UAAU,CAACvB,KAFR,CAGH,GAAIU,KAAJ,CAASa,UAAU,CAACP,UAApB,CAHG,CAAL,CAKD,CACF,CAbc,CAaZ,CAACV,KAAD,CAbY,CAAf,CAeA,MAAO,CAAEN,KAAK,CAALA,KAAF,CAASE,MAAM,CAANA,MAAT,CAAiBI,KAAK,CAALA,KAAjB,CAAwBY,MAAM,CAANA,MAAxB,CAAP,CACD,CAtDM"},"metadata":{},"sourceType":"module"}