{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useLayoutEffect, useCallback } from \"react\";\nlet logoutTimer;\nexport const useAuth = () => {\n  _s();\n\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(null);\n  const [tokenExpirationState, setTokenExpirationState] = useState();\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    const tokenExpirationDate = expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationState(tokenExpirationDate);\n    localStorage.setItem(\"userData\", JSON.stringify({\n      userId: uid,\n      token: token,\n      expiration: tokenExpirationDate.toISOString()\n    }));\n  }, []);\n  const logout = useCallback(() => {\n    console.log(\"why\");\n    setToken(null);\n    setTokenExpirationState(null);\n    setUserId(null);\n    localStorage.removeItem(\"userData\");\n  }, []);\n  useEffect(() => {\n    if (token && tokenExpirationState) {\n      const remainingTime = tokenExpirationState.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationState]);\n  useLayoutEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem(\"userData\"));\n\n    if (storedData && storedData.token && new Date(storedData.expiration) > new Date()) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n  return {\n    token,\n    userId,\n    login,\n    logout\n  };\n};\n\n_s(useAuth, \"S4w7hSvzWjTR4I5F9F4ox9ZV2to=\");","map":{"version":3,"names":["useEffect","useState","useLayoutEffect","useCallback","logoutTimer","useAuth","token","setToken","userId","setUserId","tokenExpirationState","setTokenExpirationState","login","uid","expirationDate","tokenExpirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","console","log","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem"],"sources":["/Users/shawn/Desktop/Web development/reactNew/frontend/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useEffect, useState, useLayoutEffect, useCallback } from \"react\";\n\nlet logoutTimer;\n\nexport const useAuth = () => {\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(null);\n  const [tokenExpirationState, setTokenExpirationState] = useState();\n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationState(tokenExpirationDate);\n    localStorage.setItem(\n      \"userData\",\n      JSON.stringify({\n        userId: uid,\n        token: token,\n        expiration: tokenExpirationDate.toISOString(),\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    console.log(\"why\");\n    setToken(null);\n    setTokenExpirationState(null);\n    setUserId(null);\n    localStorage.removeItem(\"userData\");\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationState) {\n      const remainingTime =\n        tokenExpirationState.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationState]);\n\n  useLayoutEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem(\"userData\"));\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(\n        storedData.userId,\n        storedData.token,\n        new Date(storedData.expiration)\n      );\n    }\n  }, [login]);\n\n  return { token, userId, login, logout };\n};\n"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,eAA9B,EAA+CC,WAA/C,QAAkE,OAAlE;AAEA,IAAIC,WAAJ;AAEA,OAAO,MAAMC,OAAO,GAAG,MAAM;EAAA;;EAC3B,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBN,QAAQ,CAAC,KAAD,CAAlC;EACA,MAAM,CAACO,MAAD,EAASC,SAAT,IAAsBR,QAAQ,CAAC,IAAD,CAApC;EACA,MAAM,CAACS,oBAAD,EAAuBC,uBAAvB,IAAkDV,QAAQ,EAAhE;EAEA,MAAMW,KAAK,GAAGT,WAAW,CAAC,CAACU,GAAD,EAAMP,KAAN,EAAaQ,cAAb,KAAgC;IACxDP,QAAQ,CAACD,KAAD,CAAR;IACAG,SAAS,CAACI,GAAD,CAAT;IACA,MAAME,mBAAmB,GACvBD,cAAc,IAAI,IAAIE,IAAJ,CAAS,IAAIA,IAAJ,GAAWC,OAAX,KAAuB,OAAO,EAAP,GAAY,EAA5C,CADpB;IAEAN,uBAAuB,CAACI,mBAAD,CAAvB;IACAG,YAAY,CAACC,OAAb,CACE,UADF,EAEEC,IAAI,CAACC,SAAL,CAAe;MACbb,MAAM,EAAEK,GADK;MAEbP,KAAK,EAAEA,KAFM;MAGbgB,UAAU,EAAEP,mBAAmB,CAACQ,WAApB;IAHC,CAAf,CAFF;EAQD,CAdwB,EActB,EAdsB,CAAzB;EAgBA,MAAMC,MAAM,GAAGrB,WAAW,CAAC,MAAM;IAC/BsB,OAAO,CAACC,GAAR,CAAY,KAAZ;IACAnB,QAAQ,CAAC,IAAD,CAAR;IACAI,uBAAuB,CAAC,IAAD,CAAvB;IACAF,SAAS,CAAC,IAAD,CAAT;IACAS,YAAY,CAACS,UAAb,CAAwB,UAAxB;EACD,CANyB,EAMvB,EANuB,CAA1B;EAQA3B,SAAS,CAAC,MAAM;IACd,IAAIM,KAAK,IAAII,oBAAb,EAAmC;MACjC,MAAMkB,aAAa,GACjBlB,oBAAoB,CAACO,OAArB,KAAiC,IAAID,IAAJ,GAAWC,OAAX,EADnC;MAEAb,WAAW,GAAGyB,UAAU,CAACL,MAAD,EAASI,aAAT,CAAxB;IACD,CAJD,MAIO;MACLE,YAAY,CAAC1B,WAAD,CAAZ;IACD;EACF,CARQ,EAQN,CAACE,KAAD,EAAQkB,MAAR,EAAgBd,oBAAhB,CARM,CAAT;EAUAR,eAAe,CAAC,MAAM;IACpB,MAAM6B,UAAU,GAAGX,IAAI,CAACY,KAAL,CAAWd,YAAY,CAACe,OAAb,CAAqB,UAArB,CAAX,CAAnB;;IACA,IACEF,UAAU,IACVA,UAAU,CAACzB,KADX,IAEA,IAAIU,IAAJ,CAASe,UAAU,CAACT,UAApB,IAAkC,IAAIN,IAAJ,EAHpC,EAIE;MACAJ,KAAK,CACHmB,UAAU,CAACvB,MADR,EAEHuB,UAAU,CAACzB,KAFR,EAGH,IAAIU,IAAJ,CAASe,UAAU,CAACT,UAApB,CAHG,CAAL;IAKD;EACF,CAbc,EAaZ,CAACV,KAAD,CAbY,CAAf;EAeA,OAAO;IAAEN,KAAF;IAASE,MAAT;IAAiBI,KAAjB;IAAwBY;EAAxB,CAAP;AACD,CAvDM;;GAAMnB,O"},"metadata":{},"sourceType":"module"}